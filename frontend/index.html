<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>StockSense AI ‚Äî Indian Market Intelligence</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <script src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>
  
  <script src="https://unpkg.com/recharts@2.10.3/umd/Recharts.js"></script>
  
  <script src="https://unpkg.com/@babel/standalone@7.23.5/babel.min.js"></script>
  <link rel="icon" href="data:;base64,iVBORw0KGgo=">
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #080c10;
      --surface: #0d1218;
      --surface2: #131a22;
      --border: #1e2a36;
      --border2: #243040;
      --text: #e8edf3;
      --text2: #7a90a8;
      --text3: #4a5a6a;
      --bull: #00e676;
      --bull-dim: #00e67622;
      --bear: #ff3d5a;
      --bear-dim: #ff3d5a22;
      --neutral: #ffc107;
      --neutral-dim: #ffc10722;
      --accent: #00b4ff;
      --accent-dim: #00b4ff18;
      --accent2: #a855f7;
      --glow: 0 0 30px #00b4ff18;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'DM Sans', sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }
    /* Scanline overlay */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background: repeating-linear-gradient(0deg, transparent, transparent 2px, #ffffff03 2px, #ffffff03 4px);
      pointer-events: none;
      z-index: 9999;
    }
    /* Grid background */
    body::after {
      content: '';
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(#1a2535 1px, transparent 1px),
        linear-gradient(90deg, #1a2535 1px, transparent 1px);
      background-size: 40px 40px;
      opacity: 0.3;
      pointer-events: none;
      z-index: 0;
    }
    .app { position: relative; z-index: 1; }

    /* NAV */
    .nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 32px;
      border-bottom: 1px solid var(--border);
      background: #080c10cc;
      backdrop-filter: blur(20px);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .nav-logo {
      font-family: 'Syne', sans-serif;
      font-weight: 800;
      font-size: 20px;
      letter-spacing: -0.5px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .logo-dot {
      width: 8px; height: 8px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 10px var(--accent);
      animation: pulse 2s infinite;
    }
    @keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:.5;transform:scale(1.4)} }
    .nav-search {
      display: flex;
      align-items: center;
      gap: 10px;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 8px 14px;
      min-width: 320px;
      transition: border-color .2s;
    }
    .nav-search:focus-within { border-color: var(--accent); box-shadow: 0 0 0 2px var(--accent-dim); }
    .nav-search input {
      background: none;
      border: none;
      outline: none;
      color: var(--text);
      font-family: 'Space Mono', monospace;
      font-size: 13px;
      width: 100%;
    }
    .nav-search input::placeholder { color: var(--text3); }
    .nav-right { display: flex; align-items: center; gap: 16px; }
    .live-badge {
      display: flex; align-items: center; gap: 6px;
      font-family: 'Space Mono', monospace;
      font-size: 11px;
      color: var(--bull);
      background: var(--bull-dim);
      border: 1px solid #00e67640;
      border-radius: 20px;
      padding: 4px 10px;
    }
    .live-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--bull); animation: pulse 1.5s infinite; }

    /* TICKER BAR */
    .ticker-bar {
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      padding: 8px 0;
      overflow: hidden;
      font-family: 'Space Mono', monospace;
      font-size: 12px;
    }
    .ticker-track {
      display: flex;
      gap: 40px;
      white-space: nowrap;
      animation: ticker 30s linear infinite;
    }
    @keyframes ticker { from{transform:translateX(0)} to{transform:translateX(-50%)} }
    .ticker-item { display: flex; align-items: center; gap: 8px; }
    .ticker-symbol { color: var(--text2); font-weight: 700; }
    .ticker-price { color: var(--text); }
    .ticker-chg.up { color: var(--bull); }
    .ticker-chg.down { color: var(--bear); }

    /* LAYOUT */
    .main-layout {
      display: grid;
      grid-template-columns: 280px 1fr 320px;
      gap: 0;
      min-height: calc(100vh - 105px);
    }
    .sidebar-left {
      border-right: 1px solid var(--border);
      padding: 20px;
      overflow-y: auto;
    }
    .main-content {
      padding: 24px;
      overflow-y: auto;
    }
    .sidebar-right {
      border-left: 1px solid var(--border);
      padding: 20px;
      overflow-y: auto;
    }

    /* SECTION HEADERS */
    .section-label {
      font-family: 'Space Mono', monospace;
      font-size: 10px;
      letter-spacing: 2px;
      color: var(--text3);
      text-transform: uppercase;
      margin-bottom: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .section-label::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--border);
    }

    /* CARDS */
    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 16px;
      margin-bottom: 12px;
      transition: border-color .2s, box-shadow .2s;
    }
    .card:hover { border-color: var(--border2); box-shadow: var(--glow); }
    .card.clickable { cursor: pointer; }
    .card.clickable:hover { border-color: var(--accent); }

    /* WATCHLIST */
    .watchlist-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: background .15s;
      margin-bottom: 6px;
    }
    .watchlist-item:hover { background: var(--surface2); }
    .watchlist-item.active { background: var(--accent-dim); border: 1px solid #00b4ff30; }
    .wl-sym { font-family: 'Space Mono', monospace; font-size: 13px; font-weight: 700; color: var(--text); }
    .wl-name { font-size: 11px; color: var(--text3); margin-top: 2px; }
    .wl-price { text-align: right; }
    .wl-pval { font-family: 'Space Mono', monospace; font-size: 13px; }
    .wl-pchg { font-family: 'Space Mono', monospace; font-size: 11px; }
    .up { color: var(--bull); }
    .down { color: var(--bear); }
    .neutral-color { color: var(--neutral); }

    /* MARKET MOOD */
    .mood-gauge {
      position: relative;
      width: 100%;
      height: 80px;
      margin: 12px 0;
    }
    .mood-label-big {
      font-family: 'Syne', sans-serif;
      font-size: 22px;
      font-weight: 800;
      text-align: center;
    }
    .mood-score {
      font-family: 'Space Mono', monospace;
      font-size: 36px;
      font-weight: 700;
      text-align: center;
    }

    /* STOCK HEADER */
    .stock-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 24px;
    }
    .stock-name-block .sym {
      font-family: 'Space Mono', monospace;
      font-size: 13px;
      color: var(--accent);
      margin-bottom: 4px;
    }
    .stock-name-block h1 {
      font-family: 'Syne', sans-serif;
      font-size: 26px;
      font-weight: 800;
      line-height: 1.1;
    }
    .stock-name-block .sector-tag {
      display: inline-block;
      background: var(--accent-dim);
      border: 1px solid #00b4ff30;
      color: var(--accent);
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 4px;
      margin-top: 8px;
      font-family: 'Space Mono', monospace;
    }
    .price-block { text-align: right; }
    .price-big {
      font-family: 'Space Mono', monospace;
      font-size: 32px;
      font-weight: 700;
    }
    .price-change {
      font-family: 'Space Mono', monospace;
      font-size: 14px;
      margin-top: 4px;
    }

    /* VERDICT CARD */
    .verdict-card {
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      position: relative;
      overflow: hidden;
    }
    .verdict-card.bull { background: linear-gradient(135deg, #00e67610, #00e67604); border: 1px solid #00e67640; }
    .verdict-card.bear { background: linear-gradient(135deg, #ff3d5a10, #ff3d5a04); border: 1px solid #ff3d5a40; }
    .verdict-card.neut { background: linear-gradient(135deg, #ffc10710, #ffc10704); border: 1px solid #ffc10740; }
    .verdict-label {
      font-family: 'Syne', sans-serif;
      font-size: 22px;
      font-weight: 800;
      letter-spacing: -0.5px;
    }
    .verdict-outlook {
      font-size: 14px;
      color: var(--text2);
      margin: 8px 0 12px;
    }
    .verdict-summary {
      font-size: 13px;
      color: var(--text2);
      line-height: 1.6;
      border-top: 1px solid var(--border);
      padding-top: 12px;
    }
    .verdict-meta {
      display: flex;
      gap: 20px;
      margin-top: 12px;
    }
    .verdict-meta-item { text-align: center; }
    .vmeta-val {
      font-family: 'Space Mono', monospace;
      font-size: 18px;
      font-weight: 700;
    }
    .vmeta-lbl { font-size: 10px; color: var(--text3); letter-spacing: 1px; text-transform: uppercase; }
    .confidence-bar {
      height: 4px;
      background: var(--border);
      border-radius: 2px;
      margin-top: 10px;
      overflow: hidden;
    }
    .confidence-fill {
      height: 100%;
      border-radius: 2px;
      transition: width 1s ease;
    }

    /* NEWS BREAKDOWN */
    .breakdown-row {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }
    .bd-chip {
      flex: 1;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
    }
    .bd-chip.bull { background: var(--bull-dim); border: 1px solid #00e67630; }
    .bd-chip.bear { background: var(--bear-dim); border: 1px solid #ff3d5a30; }
    .bd-chip.neut { background: var(--neutral-dim); border: 1px solid #ffc10730; }
    .bd-chip-val { font-family: 'Space Mono', monospace; font-size: 20px; font-weight: 700; }
    .bd-chip-lbl { font-size: 10px; color: var(--text3); text-transform: uppercase; letter-spacing: 1px; margin-top: 2px; }

    /* CHART */
    .chart-container { margin-bottom: 20px; }
    .chart-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
    .chart-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 16px; }
    .chart-tabs { display: flex; gap: 4px; }
    .chart-tab {
      padding: 4px 10px;
      border-radius: 4px;
      font-family: 'Space Mono', monospace;
      font-size: 11px;
      cursor: pointer;
      color: var(--text3);
      border: 1px solid transparent;
      background: none;
      transition: all .15s;
    }
    .chart-tab.active { background: var(--accent-dim); color: var(--accent); border-color: #00b4ff30; }

    /* NEWS CARDS */
    .news-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 14px;
      margin-bottom: 10px;
      transition: border-color .2s;
    }
    .news-card:hover { border-color: var(--border2); }
    .news-card.bull-news { border-left: 3px solid var(--bull); }
    .news-card.bear-news { border-left: 3px solid var(--bear); }
    .news-card.neut-news { border-left: 3px solid var(--neutral); }
    .news-top { display: flex; align-items: flex-start; justify-content: space-between; gap: 10px; margin-bottom: 8px; }
    .news-title { font-size: 13px; font-weight: 500; line-height: 1.4; flex: 1; }
    .news-badges { display: flex; flex-direction: column; align-items: flex-end; gap: 4px; flex-shrink: 0; }
    .badge {
      font-family: 'Space Mono', monospace;
      font-size: 10px;
      padding: 3px 7px;
      border-radius: 4px;
      white-space: nowrap;
    }
    .badge.bull { background: var(--bull-dim); color: var(--bull); border: 1px solid #00e67640; }
    .badge.bear { background: var(--bear-dim); color: var(--bear); border: 1px solid #ff3d5a40; }
    .badge.neut { background: var(--neutral-dim); color: var(--neutral); border: 1px solid #ffc10740; }
    .badge.high { background: #ff3d5a22; color: #ff6b7a; border: 1px solid #ff3d5a40; }
    .badge.medium { background: #ffc10722; color: #ffd54f; border: 1px solid #ffc10740; }
    .badge.low { background: #00b4ff18; color: var(--accent); border: 1px solid #00b4ff30; }
    .news-reasoning {
      font-size: 12px;
      color: var(--text2);
      line-height: 1.5;
      margin: 8px 0;
      padding: 8px 10px;
      background: var(--surface2);
      border-radius: 6px;
    }
    .news-meta {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 8px;
    }
    .news-meta span { font-size: 11px; color: var(--text3); font-family: 'Space Mono', monospace; }
    .risk-flags { display: flex; gap: 4px; flex-wrap: wrap; margin-top: 6px; }
    .risk-flag {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 3px;
      background: #ff3d5a15;
      color: #ff6b7a;
      border: 1px solid #ff3d5a30;
    }
    .historical-note {
      font-size: 11px;
      color: #7a90a8;
      margin-top: 6px;
      padding: 6px 8px;
      border-left: 2px solid var(--accent);
      background: var(--accent-dim);
      border-radius: 0 4px 4px 0;
    }

    /* STOCK STATS */
    .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 20px; }
    .stat-box {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px 12px;
    }
    .stat-lbl { font-size: 10px; color: var(--text3); letter-spacing: 1px; text-transform: uppercase; }
    .stat-val { font-family: 'Space Mono', monospace; font-size: 14px; font-weight: 700; margin-top: 2px; }

    /* LOADING & EMPTY */
    .loader {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 300px;
      gap: 16px;
    }
    .spinner {
      width: 40px; height: 40px;
      border: 3px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .loader-text { font-family: 'Space Mono', monospace; font-size: 12px; color: var(--text3); }

    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 400px;
      gap: 16px;
      color: var(--text3);
    }
    .empty-icon { font-size: 48px; }
    .empty-title { font-family: 'Syne', sans-serif; font-size: 18px; font-weight: 700; color: var(--text2); }
    .empty-sub { font-size: 13px; text-align: center; max-width: 300px; line-height: 1.5; }

    /* QUICK PICKS */
    .quick-picks { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 20px; }
    .quick-pick {
      padding: 5px 12px;
      border-radius: 20px;
      background: var(--surface2);
      border: 1px solid var(--border);
      font-family: 'Space Mono', monospace;
      font-size: 11px;
      color: var(--text2);
      cursor: pointer;
      transition: all .15s;
    }
    .quick-pick:hover { border-color: var(--accent); color: var(--accent); background: var(--accent-dim); }

    /* DISCLAIMER */
    .disclaimer {
      background: #ffc10712;
      border: 1px solid #ffc10730;
      border-radius: 8px;
      padding: 10px 14px;
      font-size: 11px;
      color: #ffd54f;
      line-height: 1.5;
      margin-top: 20px;
    }

    /* SEARCH BTN */
    .search-btn {
      background: var(--accent);
      color: #000;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      font-family: 'Space Mono', monospace;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      transition: opacity .15s;
    }
    .search-btn:hover { opacity: 0.85; }
    .search-btn:disabled { opacity: 0.4; cursor: not-allowed; }

    /* INDEX CARDS */
    .index-cards { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    .index-card {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px;
    }
    .index-name { font-size: 10px; color: var(--text3); font-family: 'Space Mono', monospace; letter-spacing: 1px; }
    .index-price { font-family: 'Space Mono', monospace; font-size: 15px; font-weight: 700; margin-top: 3px; }
    .index-chg { font-family: 'Space Mono', monospace; font-size: 11px; margin-top: 2px; }

    /* TOOLTIP */
    .custom-tooltip {
      background: var(--surface2);
      border: 1px solid var(--border2);
      border-radius: 6px;
      padding: 8px 12px;
      font-family: 'Space Mono', monospace;
      font-size: 12px;
    }

    @media (max-width: 1200px) {
      .main-layout { grid-template-columns: 240px 1fr; }
      .sidebar-right { display: none; }
    }
    @media (max-width: 768px) {
      .main-layout { grid-template-columns: 1fr; }
      .sidebar-left { display: none; }
      .nav-search { min-width: 200px; }
    }
  </style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect, useCallback, useRef } = React;
const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, AreaChart, Area, ReferenceLine } = window.Recharts;

// ‚îÄ‚îÄ CONFIG ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const API_BASE = "http://localhost:8000/api";

const WATCHLIST_SYMBOLS = [
  { sym: "RELIANCE", name: "Reliance Industries" },
  { sym: "TCS", name: "Tata Consultancy" },
  { sym: "INFY", name: "Infosys" },
  { sym: "HDFCBANK", name: "HDFC Bank" },
  { sym: "ADANIENT", name: "Adani Enterprises" },
  { sym: "WIPRO", name: "Wipro Ltd" },
  { sym: "SBIN", name: "State Bank of India" },
  { sym: "BTC", name: "Bitcoin" },
  { sym: "ETH", name: "Ethereum" },
];

const QUICK_PICKS = ["RELIANCE", "TCS", "INFY", "HDFCBANK", "ADANIENT", "TATAMOTORS", "SUNPHARMA", "BTC", "ETH", "SOL"];

// ‚îÄ‚îÄ MOCK DATA (used when backend is offline for demo) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function getMockData(symbol) {
  const isCrypto = ["BTC","ETH","SOL","BNB","DOGE","XRP"].includes(symbol);
  const price = isCrypto ? 67234 : 2456;
  const chg = (Math.random() - 0.45) * 4;

  const history = Array.from({length: 30}, (_, i) => ({
    date: new Date(Date.now() - (29-i) * 86400000).toISOString().split('T')[0],
    price: +(price * (0.92 + Math.random() * 0.16)).toFixed(2),
    volume: Math.floor(Math.random() * 5000000 + 1000000),
  }));

  const newsItems = [
    {
      title: `${symbol} posts strong quarterly earnings, beats analyst estimates`,
      source: "Economic Times", published: "2 hours ago",
      sentiment: "STRONGLY BULLISH", direction: "UP", impact: "HIGH",
      event_type: "Earnings Report", confidence: 82, color: "bullish",
      reasoning: "This is classified as an **Earnings Report** event with **HIGH impact**. Positive signals detected: strong earnings language indicates near-term upside. Confidence is high (82%) based on clear signal strength.",
      historical_pattern: "Strong earnings beats typically drive 2‚Äì5% gains in the session following the announcement.",
      risk_flags: [], time_horizon: "1‚Äì2 trading days", avg_historical_impact: 2.1,
    },
    {
      title: `SEBI issues notice to ${symbol} over disclosure norms`,
      source: "Moneycontrol", published: "5 hours ago",
      sentiment: "STRONGLY BEARISH", direction: "DOWN", impact: "HIGH",
      event_type: "Regulatory Action", confidence: 78, color: "bearish",
      reasoning: "This is classified as a **Regulatory Action** event with **HIGH impact**. Negative signals detected: regulatory pressure suggests downside. ‚ö†Ô∏è Risk flags identified: Regulatory Risk. Moderate confidence (78%).",
      historical_pattern: "SEBI notices have historically caused 3‚Äì8% corrections in large caps within 2‚Äì3 trading days.",
      risk_flags: ["Regulatory Risk"], time_horizon: "3‚Äì7 trading days", avg_historical_impact: -4.2,
    },
    {
      title: `${symbol} announces strategic expansion into new markets`,
      source: "Business Standard", published: "8 hours ago",
      sentiment: "MILDLY BULLISH", direction: "UP", impact: "MEDIUM",
      event_type: "Business Update", confidence: 63, color: "bullish",
      reasoning: "This is classified as a **Business Update** event with **MEDIUM impact**. Positive signals detected: expansion news indicates growth trajectory. Moderate confidence (63%). Watch for confirming price action.",
      historical_pattern: "New contract wins typically boost sentiment by 1‚Äì3%, especially in IT and infra sectors.",
      risk_flags: [], time_horizon: "1‚Äì3 trading days", avg_historical_impact: 1.2,
    },
    {
      title: `Analyst upgrades ${symbol} to 'Outperform', raises target price`,
      source: "NDTV Profit", published: "Yesterday",
      sentiment: "MILDLY BULLISH", direction: "UP", impact: "MEDIUM",
      event_type: "Business Update", confidence: 68, color: "bullish",
      reasoning: "This is classified as a **Business Update** event with **MEDIUM impact**. Analyst upgrade signals institutional confidence. Moderate confidence (68%).",
      historical_pattern: "Analyst upgrades typically drive 1‚Äì2% positive movement over 1‚Äì3 days.",
      risk_flags: [], time_horizon: "1‚Äì2 trading days", avg_historical_impact: 1.5,
    },
    {
      title: `${symbol} board meeting scheduled; dividend announcement expected`,
      source: "Economic Times", published: "Yesterday",
      sentiment: "NEUTRAL", direction: "SIDEWAYS", impact: "LOW",
      event_type: "Corporate Action", confidence: 45, color: "neutral",
      reasoning: "This is classified as a **Corporate Action** event with **LOW impact**. No strong directional keywords detected; market may remain range-bound. Low confidence (45%). News signal is ambiguous.",
      historical_pattern: "Dividend declarations and buybacks signal financial strength, typically adding 1‚Äì3%.",
      risk_flags: [], time_horizon: "1‚Äì3 trading days", avg_historical_impact: 1.8,
    },
  ];

  const bullCount = newsItems.filter(n => n.direction === "UP").length;
  const bearCount = newsItems.filter(n => n.direction === "DOWN").length;

  return {
    symbol, ticker: isCrypto ? `${symbol}-USD` : `${symbol}.NS`,
    name: isCrypto ? `${symbol} / USD` : `${symbol} Limited`,
    sector: isCrypto ? "Cryptocurrency" : "Large Cap",
    is_crypto: isCrypto,
    current_price: price + chg,
    currency: isCrypto ? "USD" : "INR",
    price_change: +(chg).toFixed(2),
    price_change_pct: +(chg/price*100).toFixed(2),
    market_cap: price * 1000000000,
    volume: 5200000,
    "52w_high": price * 1.25,
    "52w_low": price * 0.75,
    price_history: history,
    news: newsItems,
    verdict: {
      label: "CAUTIOUSLY BULLISH",
      emoji: "üü°",
      risk_level: "MEDIUM",
      short_term_outlook: "Mixed signals ‚Äî earnings beat offset by regulatory action",
      summary: `Analyzed 5 recent news items. ${bullCount} bullish, ${bearCount} bearish, 1 neutral. High-impact events: Earnings beat; SEBI notice. Exercise caution on regulatory news. ‚ö†Ô∏è This is AI-generated analysis for educational purposes only. Not financial advice.`,
      news_breakdown: { bullish: bullCount, bearish: bearCount, neutral: 1 },
      high_impact_events: newsItems.filter(n => n.impact === "HIGH"),
      confidence: 67,
      net_sentiment_score: 0.12,
    },
    last_updated: new Date().toISOString(),
    _demo_mode: true,
  };
}

function getMockMarket() {
  return {
    indices: {
      NIFTY50: { price: 22450.50, change_pct: 0.42, direction: "up" },
      SENSEX: { price: 73850.12, change_pct: 0.38, direction: "up" },
      NIFTYBANK: { price: 48230.75, change_pct: -0.21, direction: "down" },
      BTC: { price: 67234.00, change_pct: 2.14, direction: "up" },
      ETH: { price: 3542.80, change_pct: 1.87, direction: "up" },
    },
    mood_score: 62,
    mood_label: "Greed",
    _demo_mode: true,
  };
}

// ‚îÄ‚îÄ UTILITIES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function fmt(n, currency = "INR") {
  if (!n && n !== 0) return "‚Äî";
  if (currency === "USD") return `$${Number(n).toLocaleString("en-US", {maximumFractionDigits: 2})}`;
  return `‚Çπ${Number(n).toLocaleString("en-IN", {maximumFractionDigits: 2})}`;
}
function fmtShort(n) {
  if (!n) return "‚Äî";
  if (n >= 1e12) return `‚Çπ${(n/1e12).toFixed(2)}T`;
  if (n >= 1e9) return `‚Çπ${(n/1e9).toFixed(2)}B`;
  if (n >= 1e7) return `‚Çπ${(n/1e7).toFixed(2)}Cr`;
  return `‚Çπ${n.toLocaleString()}`;
}
function getVerdictClass(label) {
  if (!label) return "neut";
  if (label.includes("BULL")) return "bull";
  if (label.includes("BEAR")) return "bear";
  return "neut";
}
function getMoodColor(score) {
  if (score < 25) return "#ff3d5a";
  if (score < 45) return "#ff7043";
  if (score < 55) return "#ffc107";
  if (score < 75) return "#66bb6a";
  return "#00e676";
}

// ‚îÄ‚îÄ COMPONENTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function CustomTooltip({ active, payload, label }) {
  if (!active || !payload?.length) return null;
  return (
    <div className="custom-tooltip">
      <div style={{color:"#7a90a8",fontSize:10,marginBottom:4}}>{label}</div>
      <div style={{color:"#e8edf3",fontWeight:700}}>‚Çπ{payload[0].value?.toLocaleString()}</div>
    </div>
  );
}

function MoodGauge({ score, label }) {
  const color = getMoodColor(score);
  const rotation = -90 + (score / 100) * 180;
  return (
    <div style={{textAlign:"center", padding:"8px 0"}}>
      <svg width="140" height="80" viewBox="0 0 140 80" style={{display:"block",margin:"0 auto"}}>
        <defs>
          <linearGradient id="gaugeGrad" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stopColor="#ff3d5a"/>
            <stop offset="50%" stopColor="#ffc107"/>
            <stop offset="100%" stopColor="#00e676"/>
          </linearGradient>
        </defs>
        <path d="M 10 70 A 60 60 0 0 1 130 70" fill="none" stroke="#1e2a36" strokeWidth="14" strokeLinecap="round"/>
        <path d="M 10 70 A 60 60 0 0 1 130 70" fill="none" stroke="url(#gaugeGrad)" strokeWidth="14" strokeLinecap="round" opacity="0.8"/>
        <g transform={`rotate(${rotation}, 70, 70)`}>
          <line x1="70" y1="70" x2="70" y2="18" stroke={color} strokeWidth="3" strokeLinecap="round"/>
          <circle cx="70" cy="70" r="5" fill={color}/>
        </g>
      </svg>
      <div className="mood-score" style={{color, fontSize:28}}>{score}</div>
      <div style={{fontFamily:"'Space Mono',monospace",fontSize:12,color,marginTop:4}}>{label}</div>
    </div>
  );
}

function NewsCard({ item }) {
  const [expanded, setExpanded] = useState(false);
  const colorClass = item.color === "bullish" ? "bull-news" : item.color === "bearish" ? "bear-news" : "neut-news";
  const badgeClass = item.direction === "UP" ? "bull" : item.direction === "DOWN" ? "bear" : "neut";
  const impactClass = item.impact === "HIGH" ? "high" : item.impact === "MEDIUM" ? "medium" : "low";

  return (
    <div className={`news-card ${colorClass}`} onClick={() => setExpanded(!expanded)} style={{cursor:"pointer"}}>
      <div className="news-top">
        <div className="news-title">{item.title}</div>
        <div className="news-badges">
          <span className={`badge ${badgeClass}`}>
            {item.direction === "UP" ? "‚ñ≤" : item.direction === "DOWN" ? "‚ñº" : "‚óÜ"} {item.sentiment}
          </span>
          <span className={`badge ${impactClass}`}>{item.impact} IMPACT</span>
        </div>
      </div>

      {item.risk_flags?.length > 0 && (
        <div className="risk-flags">
          {item.risk_flags.map(f => <span key={f} className="risk-flag">‚ö† {f}</span>)}
        </div>
      )}

      {expanded && (
        <>
          <div className="news-reasoning">{item.reasoning}</div>
          {item.historical_pattern && (
            <div className="historical-note">üìä {item.historical_pattern}</div>
          )}
        </>
      )}

      <div className="news-meta">
        <span>üì∞ {item.source}</span>
        <span>‚è± {item.time_horizon}</span>
        <span>üéØ {item.confidence}% confidence</span>
        {!expanded && <span style={{marginLeft:"auto",color:"#4a5a6a"}}>tap to expand</span>}
      </div>
    </div>
  );
}

function StockView({ data }) {
  const [chartPeriod, setChartPeriod] = useState("30d");
  if (!data) return null;

  const verdictClass = getVerdictClass(data.verdict?.label);
  const priceUp = data.price_change_pct >= 0;
  const currency = data.currency;

  const chartData = data.price_history || [];

  const minP = Math.min(...chartData.map(d => d.price)) * 0.998;
  const maxP = Math.max(...chartData.map(d => d.price)) * 1.002;

  const formatPrice = (v) => currency === "USD" ? `$${v.toLocaleString()}` : `‚Çπ${v.toLocaleString()}`;

  return (
    <div>
      {data._demo_mode && (
        <div style={{background:"#ffc10715",border:"1px solid #ffc10740",borderRadius:8,padding:"8px 14px",marginBottom:16,fontSize:12,color:"#ffd54f",fontFamily:"'Space Mono',monospace"}}>
          ‚ö° DEMO MODE ‚Äî Backend offline. Showing simulated data. Start backend for live data.
        </div>
      )}

      {/* Stock Header */}
      <div className="stock-header">
        <div className="stock-name-block">
          <div className="sym">{data.ticker}</div>
          <h1>{data.name}</h1>
          <span className="sector-tag">{data.sector}</span>
        </div>
        <div className="price-block">
          <div className="price-big" style={{color: priceUp ? "var(--bull)" : "var(--bear)"}}>
            {currency === "USD" ? `$${data.current_price?.toLocaleString("en-US",{maximumFractionDigits:2})}` : `‚Çπ${data.current_price?.toLocaleString("en-IN",{maximumFractionDigits:2})}`}
          </div>
          <div className="price-change" style={{color: priceUp ? "var(--bull)" : "var(--bear)"}}>
            {priceUp ? "‚ñ≤" : "‚ñº"} {Math.abs(data.price_change_pct)?.toFixed(2)}% today
          </div>
        </div>
      </div>

      {/* Stats Grid */}
      <div className="stats-grid">
        <div className="stat-box">
          <div className="stat-lbl">Market Cap</div>
          <div className="stat-val">{fmtShort(data.market_cap)}</div>
        </div>
        <div className="stat-box">
          <div className="stat-lbl">Volume</div>
          <div className="stat-val">{data.volume ? (data.volume/1e6).toFixed(2)+"M" : "‚Äî"}</div>
        </div>
        <div className="stat-box">
          <div className="stat-lbl">52W High</div>
          <div className="stat-val" style={{color:"var(--bull)"}}>
            {formatPrice(data["52w_high"]?.toFixed(2))}
          </div>
        </div>
        <div className="stat-box">
          <div className="stat-lbl">52W Low</div>
          <div className="stat-val" style={{color:"var(--bear)"}}>
            {formatPrice(data["52w_low"]?.toFixed(2))}
          </div>
        </div>
      </div>

      {/* AI Verdict */}
      {data.verdict && (
        <div className={`verdict-card ${verdictClass}`}>
          <div style={{display:"flex",alignItems:"center",gap:12,marginBottom:4}}>
            <span style={{fontSize:28}}>{data.verdict.emoji}</span>
            <div>
              <div className="verdict-label">{data.verdict.label}</div>
              <div className="verdict-outlook">{data.verdict.short_term_outlook}</div>
            </div>
            <div style={{marginLeft:"auto",textAlign:"right"}}>
              <div style={{fontFamily:"'Space Mono',monospace",fontSize:11,color:"var(--text3)"}}>RISK</div>
              <div style={{fontFamily:"'Space Mono',monospace",fontSize:16,fontWeight:700,
                color: data.verdict.risk_level === "HIGH" ? "var(--bear)" : data.verdict.risk_level === "LOW" ? "var(--bull)" : "var(--neutral)"}}>
                {data.verdict.risk_level}
              </div>
            </div>
          </div>

          <div className="breakdown-row">
            <div className="bd-chip bull">
              <div className="bd-chip-val up">{data.verdict.news_breakdown?.bullish}</div>
              <div className="bd-chip-lbl">Bullish</div>
            </div>
            <div className="bd-chip bear">
              <div className="bd-chip-val down">{data.verdict.news_breakdown?.bearish}</div>
              <div className="bd-chip-lbl">Bearish</div>
            </div>
            <div className="bd-chip neut">
              <div className="bd-chip-val neutral-color">{data.verdict.news_breakdown?.neutral}</div>
              <div className="bd-chip-lbl">Neutral</div>
            </div>
          </div>

          <div style={{marginBottom:8}}>
            <div style={{display:"flex",justifyContent:"space-between",fontSize:11,color:"var(--text3)",fontFamily:"'Space Mono',monospace",marginBottom:4}}>
              <span>AI CONFIDENCE</span>
              <span>{data.verdict.confidence}%</span>
            </div>
            <div className="confidence-bar">
              <div className="confidence-fill" style={{
                width:`${data.verdict.confidence}%`,
                background: verdictClass === "bull" ? "var(--bull)" : verdictClass === "bear" ? "var(--bear)" : "var(--neutral)"
              }}/>
            </div>
          </div>

          <div className="verdict-summary">{data.verdict.summary}</div>
        </div>
      )}

      {/* Price Chart */}
      <div className="chart-container card" style={{padding:"16px"}}>
        <div className="chart-header">
          <div className="chart-title">Price History</div>
          <div className="chart-tabs">
            {["7d","30d"].map(p => (
              <button key={p} className={`chart-tab ${chartPeriod === p ? "active" : ""}`} onClick={() => setChartPeriod(p)}>{p.toUpperCase()}</button>
            ))}
          </div>
        </div>
        <ResponsiveContainer width="100%" height={200}>
          <AreaChart data={chartPeriod === "7d" ? chartData.slice(-7) : chartData} margin={{top:5,right:5,bottom:5,left:10}}>
            <defs>
              <linearGradient id="priceGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="5%" stopColor={priceUp ? "#00e676" : "#ff3d5a"} stopOpacity={0.3}/>
                <stop offset="95%" stopColor={priceUp ? "#00e676" : "#ff3d5a"} stopOpacity={0}/>
              </linearGradient>
            </defs>
            <CartesianGrid strokeDasharray="3 3" stroke="#1e2a36" vertical={false}/>
            <XAxis dataKey="date" tick={{fontSize:10,fill:"#4a5a6a",fontFamily:"'Space Mono',monospace"}} tickLine={false} axisLine={false}
              tickFormatter={d => d?.slice(5)}/>
            <YAxis domain={[minP, maxP]} tick={{fontSize:10,fill:"#4a5a6a",fontFamily:"'Space Mono',monospace"}} tickLine={false} axisLine={false}
              tickFormatter={v => currency === "USD" ? `$${(v/1000).toFixed(0)}k` : `‚Çπ${v.toLocaleString()}`}/>
            <Tooltip content={<CustomTooltip/>}/>
            <Area type="monotone" dataKey="price" stroke={priceUp ? "#00e676" : "#ff3d5a"} strokeWidth={2} fill="url(#priceGrad)"/>
          </AreaChart>
        </ResponsiveContainer>
      </div>

      {/* News Section */}
      <div>
        <div className="section-label">üß† AI News Analysis</div>
        {data.news?.length > 0 ? (
          data.news.map((item, i) => <NewsCard key={i} item={item}/>)
        ) : (
          <div style={{color:"var(--text3)",fontSize:13,padding:"20px 0"}}>No recent news found for this symbol.</div>
        )}
      </div>

      <div className="disclaimer">
        ‚ö†Ô∏è <strong>Educational Tool Only.</strong> StockSense AI does not provide financial advice. All analysis is probabilistic and AI-generated. Past patterns do not guarantee future performance. Consult a SEBI-registered financial advisor before making investment decisions.
      </div>
    </div>
  );
}

// ‚îÄ‚îÄ MAIN APP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function App() {
  const [searchInput, setSearchInput] = useState("");
  const [activeSymbol, setActiveSymbol] = useState(null);
  const [stockData, setStockData] = useState(null);
  const [marketData, setMarketData] = useState(null);
  const [watchlistData, setWatchlistData] = useState({});
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);
  const inputRef = useRef(null);

  // Load market overview
  useEffect(() => {
    fetchMarket();
    const interval = setInterval(fetchMarket, 60000);
    return () => clearInterval(interval);
  }, []);

  async function fetchMarket() {
    try {
      const res = await fetch(`${API_BASE}/market/overview`);
      if (res.ok) setMarketData(await res.json());
      else setMarketData(getMockMarket());
    } catch {
      setMarketData(getMockMarket());
    }
  }

  async function fetchWatchlistItem(sym) {
    try {
      const res = await fetch(`${API_BASE}/watchlist`);
      if (res.ok) {
        const d = await res.json();
        const wl = {};
        d.watchlist.forEach(i => wl[i.symbol] = i);
        setWatchlistData(wl);
      }
    } catch {}
  }

  useEffect(() => { fetchWatchlistItem(); }, []);

  async function analyzeSymbol(sym) {
    if (!sym?.trim()) return;
    const symbol = sym.trim().toUpperCase();
    setActiveSymbol(symbol);
    setLoading(true);
    setError(null);
    setStockData(null);

    try {
      const res = await fetch(`${API_BASE}/stock/${symbol}`);
      if (res.ok) {
        setStockData(await res.json());
      } else {
        // Use mock data for demo
        setStockData(getMockData(symbol));
      }
    } catch {
      setStockData(getMockData(symbol));
    } finally {
      setLoading(false);
    }
  }

  function handleSearch(e) {
    e.preventDefault();
    if (searchInput.trim()) analyzeSymbol(searchInput);
  }

  // Ticker bar items
  const tickerItems = marketData ? Object.entries(marketData.indices) : [];
  const tickerDoubled = [...tickerItems, ...tickerItems]; // loop effect

  return (
    <div className="app">
      {/* NAV */}
      <nav className="nav">
        <div className="nav-logo">
          <div className="logo-dot"/>
          <span>StockSense<span style={{color:"var(--accent)"}}>AI</span></span>
        </div>
        <form onSubmit={handleSearch} style={{display:"flex",gap:8}}>
          <div className="nav-search">
            <span style={{color:"var(--text3)"}}>‚åï</span>
            <input
              ref={inputRef}
              value={searchInput}
              onChange={e => setSearchInput(e.target.value.toUpperCase())}
              placeholder="Search RELIANCE, TCS, BTC..."
            />
          </div>
          <button className="search-btn" type="submit" disabled={loading}>
            {loading ? "..." : "ANALYZE"}
          </button>
        </form>
        <div className="nav-right">
          <div className="live-badge">
            <div className="live-dot"/>
            LIVE
          </div>
        </div>
      </nav>

      {/* TICKER BAR */}
      {tickerItems.length > 0 && (
        <div className="ticker-bar">
          <div className="ticker-track">
            {tickerDoubled.map(([name, d], i) => (
              <div className="ticker-item" key={i}>
                <span className="ticker-symbol">{name}</span>
                <span className="ticker-price">
                  {name === "BTC" || name === "ETH" ? `$${d.price?.toLocaleString()}` : `‚Çπ${d.price?.toLocaleString()}`}
                </span>
                <span className={`ticker-chg ${d.direction}`}>
                  {d.direction === "up" ? "‚ñ≤" : "‚ñº"} {Math.abs(d.change_pct)?.toFixed(2)}%
                </span>
              </div>
            ))}
          </div>
        </div>
      )}

      {/* MAIN LAYOUT */}
      <div className="main-layout">

        {/* LEFT SIDEBAR */}
        <aside className="sidebar-left">
          <div className="section-label">Watchlist</div>
          {WATCHLIST_SYMBOLS.map(({ sym, name }) => {
            const wl = watchlistData[sym];
            const isActive = activeSymbol === sym;
            return (
              <div key={sym} className={`watchlist-item ${isActive ? "active" : ""}`} onClick={() => analyzeSymbol(sym)}>
                <div>
                  <div className="wl-sym">{sym}</div>
                  <div className="wl-name">{name}</div>
                </div>
                <div className="wl-price">
                  {wl ? (
                    <>
                      <div className="wl-pval">{sym === "BTC" || sym === "ETH" ? `$${wl.price?.toLocaleString()}` : `‚Çπ${wl.price?.toLocaleString()}`}</div>
                      <div className={`wl-pchg ${wl.direction}`}>
                        {wl.direction === "up" ? "‚ñ≤" : "‚ñº"} {Math.abs(wl.change_pct)?.toFixed(2)}%
                      </div>
                    </>
                  ) : (
                    <div className="wl-pchg" style={{color:"var(--text3)"}}>tap to load</div>
                  )}
                </div>
              </div>
            );
          })}
        </aside>

        {/* MAIN CONTENT */}
        <main className="main-content">
          {!activeSymbol ? (
            <div className="empty-state">
              <div className="empty-icon">üìä</div>
              <div className="empty-title">StockSense AI</div>
              <div className="empty-sub">Search any NSE/BSE stock or crypto to get AI-powered news analysis and market intelligence</div>
              <div style={{marginTop:8}}>
                <div className="section-label" style={{justifyContent:"center",gap:8}}>
                  <span>Quick picks</span>
                </div>
                <div className="quick-picks" style={{justifyContent:"center"}}>
                  {QUICK_PICKS.map(sym => (
                    <button key={sym} className="quick-pick" onClick={() => { setSearchInput(sym); analyzeSymbol(sym); }}>
                      {sym}
                    </button>
                  ))}
                </div>
              </div>
            </div>
          ) : loading ? (
            <div className="loader">
              <div className="spinner"/>
              <div className="loader-text">Analyzing {activeSymbol}...</div>
              <div style={{fontSize:11,color:"var(--text3)"}}>Fetching news ‚Ä¢ Running AI analysis ‚Ä¢ Computing signals</div>
            </div>
          ) : error ? (
            <div className="empty-state">
              <div className="empty-icon">‚ö†Ô∏è</div>
              <div className="empty-title">Analysis Failed</div>
              <div className="empty-sub">{error}</div>
            </div>
          ) : (
            <StockView data={stockData}/>
          )}
        </main>

        {/* RIGHT SIDEBAR */}
        <aside className="sidebar-right">
          {/* Market Mood */}
          <div className="section-label">Market Mood</div>
          <div className="card" style={{marginBottom:20}}>
            {marketData ? (
              <MoodGauge score={marketData.mood_score} label={marketData.mood_label}/>
            ) : (
              <div style={{textAlign:"center",padding:"20px 0",color:"var(--text3)"}}>Loading...</div>
            )}
          </div>

          {/* Market Indices */}
          <div className="section-label">Indices</div>
          {marketData && (
            <div className="index-cards" style={{marginBottom:20}}>
              {Object.entries(marketData.indices).map(([name, d]) => (
                <div key={name} className="index-card">
                  <div className="index-name">{name}</div>
                  <div className="index-price">
                    {name === "BTC" || name === "ETH" ? `$${d.price?.toLocaleString()}` : `‚Çπ${d.price?.toLocaleString()}`}
                  </div>
                  <div className={`index-chg ${d.direction}`}>
                    {d.direction === "up" ? "‚ñ≤" : "‚ñº"} {Math.abs(d.change_pct)?.toFixed(2)}%
                  </div>
                </div>
              ))}
            </div>
          )}

          {/* How it works */}
          <div className="section-label">How It Works</div>
          <div className="card" style={{fontSize:12,color:"var(--text2)",lineHeight:1.7}}>
            <div style={{marginBottom:8}}><span style={{color:"var(--accent)"}}>1.</span> Enter any NSE/BSE ticker or crypto symbol</div>
            <div style={{marginBottom:8}}><span style={{color:"var(--accent)"}}>2.</span> AI fetches & analyzes latest news</div>
            <div style={{marginBottom:8}}><span style={{color:"var(--accent)"}}>3.</span> Each news item is classified by sentiment, impact, event type & risk</div>
            <div style={{marginBottom:8}}><span style={{color:"var(--accent)"}}>4.</span> Overall verdict synthesizes all signals</div>
            <div style={{color:"var(--text3)",fontSize:11,marginTop:12}}>Click any news card to see the AI's reasoning chain</div>
          </div>

          {/* Fine-tuning note */}
          <div className="section-label">Fine-Tuning</div>
          <div className="card" style={{fontSize:12,color:"var(--text2)",lineHeight:1.7}}>
            <div style={{fontFamily:"'Space Mono',monospace",fontSize:11,color:"var(--accent)",marginBottom:8}}>UPGRADE PATH</div>
            <div>This demo uses rule-based NLP. Replace <code style={{color:"var(--accent)",background:"var(--surface2)",padding:"1px 4px",borderRadius:3}}>analyzer.py</code> with your fine-tuned FinBERT or Mistral-7B model for production-grade accuracy.</div>
          </div>
        </aside>
      </div>
    </div>
  );
}

const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(<App/>);
</script>
</body>
</html>
